import http.client
import json
import time
import subprocess

result = 0

def exiting():
	print("Exiting...")
	exit()

def reverse_screen():
	subprocess.run(['xrandr', '--output', 'eDP', '--rotate', 'inverted'], check=True)

def normal_screen():
	subprocess.run(['xrandr', '--output', 'eDP', '--rotate', 'normal'], check=True)

def launcher(result):
	match result:
		case "exit":
			exiting()
		case "reverse screen":
			reverse_screen()
		case "normal screen":
			normal_screen()
		case _:
			return

def main():
	global result
	while (True):
		conn = http.client.HTTPSConnection("discord.com")
		tokenpart2 = "GM3l_P.mrkZgJvU5KWSoz1-onol2XfkW6YbmzlF8H1oT4"
		headers = {
    		'Authorization': f'Bot MTIzMzQ4MTAxMDc4NDUwNTg1Nw.{tokenpart2}'
		}
		url = f"/api/v10/channels/1341791654503514122/messages?limit=1"
		conn.request("GET", url, headers=headers)
		response = conn.getresponse()
		paste_content = response.read().decode("utf-8")
		json_content = json.loads(paste_content)
		value = json_content[0]['content']
		if result != value:
			result = value
			launcher(result)
		time.sleep(1)

if __name__ == "__main__":
	main()
